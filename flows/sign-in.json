{
  "contents": {
    "startTask": "12",
    "tasks": {
      "10": {
        "allInputKeys": ["code"],
        "calculatedInputKeys": true,
        "id": "10",
        "inputsMetadata": [
          {
            "displayName": "One Time Code",
            "key": "code"
          }
        ],
        "name": "Verify TOTP",
        "next": {
          "rules": [
            {
              "interactionId": "oneTimeCodeId",
              "taskId": "11"
            }
          ]
        },
        "screenId": "SC2wZNBaG19JLoesw1Fxfwd7rPUUT",
        "type": "screen",
        "view": {
          "x": 3180,
          "y": 528
        }
      },
      "11": {
        "action": "verify-totp-code",
        "id": "11",
        "name": "Verify Code / TOTP",
        "next": {
          "rules": [
            {
              "interactionId": "success",
              "taskId": "3"
            }
          ]
        },
        "type": "automated",
        "view": {
          "x": 3660,
          "y": 564
        }
      },
      "12": {
        "action": "risk",
        "id": "12",
        "name": "Fingerprint / Assess",
        "next": {
          "rules": [
            {
              "interactionId": "success",
              "taskId": "13"
            }
          ]
        },
        "type": "automated",
        "view": {
          "x": 276,
          "y": 156
        }
      },
      "13": {
        "conditions": [
          {
            "atomicConditions": [
              {
                "operator": "is-true",
                "predicate": {
                  "type": "inline",
                  "value": ""
                },
                "target": {
                  "type": "context",
                  "value": "riskInfo.botDetected"
                }
              }
            ],
            "interactionId": "nxxr93g0gfs",
            "name": "Bot Detected"
          },
          {
            "atomicConditions": [
              {
                "operator": "greater-than",
                "predicate": {
                  "type": "inline",
                  "value": 50
                },
                "target": {
                  "type": "context",
                  "value": "riskInfo.riskScore"
                }
              }
            ],
            "interactionId": "1yhbdlz0aprh",
            "name": "Risk Score \u003e 50"
          },
          {
            "atomicConditions": [
              {
                "operator": "is-true",
                "predicate": {
                  "type": "inline",
                  "value": ""
                },
                "target": {
                  "type": "context",
                  "value": "riskInfo.impossibleTravel"
                }
              }
            ],
            "interactionId": "p06uunlt08l",
            "name": "Impossible Traveler"
          },
          {
            "atomicConditions": [],
            "interactionId": "ELSE",
            "name": "No Risks"
          }
        ],
        "errorHandlingV2": {},
        "id": "13",
        "name": "Any risk detected?",
        "next": {
          "rules": [
            {
              "interactionId": "nxxr93g0gfs",
              "taskId": "14"
            },
            {
              "interactionId": "1yhbdlz0aprh",
              "taskId": "5"
            },
            {
              "interactionId": "p06uunlt08l",
              "taskId": "5"
            },
            {
              "interactionId": "ELSE",
              "taskId": "15"
            }
          ]
        },
        "type": "condition",
        "view": {
          "x": 756,
          "y": 108
        }
      },
      "14": {
        "calculatedInputKeys": true,
        "id": "14",
        "inputsMetadata": [],
        "name": "Bot Detected",
        "next": {},
        "screenId": "SC2wZNUHVNT89BnzbXVMZj9N09Qdr",
        "type": "screen",
        "view": {
          "x": 1236,
          "y": 12
        }
      },
      "15": {
        "action": "password-sign-in-v2",
        "errorHandlingV2": {
          "PasswordExpired": {
            "errorHandlingType": "custom"
          }
        },
        "id": "15",
        "name": "Sign In / Password",
        "next": {
          "rules": [
            {
              "interactionId": "success",
              "taskId": "3"
            },
            {
              "interactionId": "PasswordExpired",
              "taskId": "16"
            }
          ]
        },
        "type": "automated",
        "view": {
          "x": 1236,
          "y": 540
        }
      },
      "16": {
        "id": "16",
        "inputsMetadata": [
          {
            "displayName": "New Password",
            "key": "newPassword"
          },
          {
            "displayName": "Login Password",
            "key": "password"
          }
        ],
        "name": "Replace Expired Password",
        "next": {
          "rules": [
            {
              "interactionId": "update-password",
              "taskId": "17"
            }
          ]
        },
        "screenId": "SC2wZNUGGEcWBw3H4wxKCUN3vitTB",
        "type": "screen",
        "view": {
          "x": 1728,
          "y": 564
        }
      },
      "17": {
        "action": "password-replace",
        "id": "17",
        "name": "Replace Password",
        "next": {
          "rules": [
            {
              "interactionId": "success",
              "taskId": "3"
            }
          ]
        },
        "type": "automated",
        "view": {
          "x": 2688,
          "y": 600
        }
      },
      "3": {
        "action": "logged-in",
        "id": "3",
        "name": "End",
        "next": {},
        "type": "automated",
        "view": {
          "x": 4140,
          "y": 636
        }
      },
      "5": {
        "action": "password-sign-in-v2",
        "errorHandlingV2": {
          "PasswordExpired": {
            "errorHandlingType": "custom"
          }
        },
        "id": "5",
        "name": "Sign In / Password",
        "next": {
          "rules": [
            {
              "interactionId": "success",
              "taskId": "8"
            },
            {
              "interactionId": "PasswordExpired",
              "taskId": "6"
            }
          ]
        },
        "type": "automated",
        "view": {
          "x": 1236,
          "y": 204
        }
      },
      "6": {
        "id": "6",
        "inputsMetadata": [
          {
            "displayName": "New Password",
            "key": "newPassword"
          },
          {
            "displayName": "Login Password",
            "key": "password"
          }
        ],
        "name": "Replace Expired Password",
        "next": {
          "rules": [
            {
              "interactionId": "update-password",
              "taskId": "7"
            }
          ]
        },
        "screenId": "SC2wWY2qAjIHsqFWp5qWBFjHUvMOZ",
        "type": "screen",
        "view": {
          "x": 1728,
          "y": 276
        }
      },
      "7": {
        "action": "password-replace",
        "id": "7",
        "name": "Replace Password",
        "next": {
          "rules": [
            {
              "interactionId": "success",
              "taskId": "8"
            }
          ]
        },
        "type": "automated",
        "view": {
          "x": 2208,
          "y": 300
        }
      },
      "8": {
        "conditions": [
          {
            "atomicConditions": [
              {
                "operator": "equal",
                "predicate": {
                  "type": "inline",
                  "value": "Passkeys"
                },
                "target": {
                  "type": "context",
                  "value": "user.customAttributes.preferredMfa"
                }
              }
            ],
            "interactionId": "ckvwyd7aqi",
            "logicalOr": false,
            "name": "Passkeys"
          },
          {
            "atomicConditions": [],
            "interactionId": "ELSE",
            "name": "TOTP"
          }
        ],
        "errorHandlingV2": {},
        "id": "8",
        "name": "What is user's preferred MFA method?",
        "next": {
          "rules": [
            {
              "interactionId": "ckvwyd7aqi",
              "taskId": "9"
            },
            {
              "interactionId": "ELSE",
              "taskId": "10"
            }
          ]
        },
        "type": "condition",
        "view": {
          "x": 2688,
          "y": 312
        }
      },
      "9": {
        "action": "webauthn-sign-in-start",
        "arguments": {
          "finishStepId": {
            "type": "inline",
            "value": "9.end"
          },
          "userVerificationDiscouraged": {
            "type": "inline",
            "value": ""
          }
        },
        "id": "9",
        "name": "Sign In / Passkeys (WebAuthn)",
        "next": {
          "rules": [
            {
              "interactionId": "success",
              "taskId": "9.end"
            }
          ]
        },
        "type": "automated",
        "view": {
          "x": 3660,
          "y": 324
        }
      },
      "9.end": {
        "action": "webauthn-sign-in-finish",
        "arguments": {
          "finishStepId": {
            "type": "inline",
            "value": "9.end"
          },
          "userVerificationDiscouraged": {
            "type": "inline",
            "value": ""
          }
        },
        "id": "9.end",
        "name": "Sign In / Passkeys (WebAuthn)",
        "next": {
          "rules": [
            {
              "interactionId": "success",
              "taskId": "3"
            }
          ]
        },
        "type": "automated",
        "view": {
          "x": 3660,
          "y": 324
        }
      },
      "start": {
        "id": "start",
        "name": "start",
        "next": {
          "rules": [
            {
              "interactionId": "",
              "taskId": "12"
            }
          ]
        },
        "view": {
          "x": 12,
          "y": 216
        }
      }
    }
  },
  "flowId": "sign-in",
  "metadata": {
    "componentsVersion": "2.0.513",
    "description": "Sign in using preferred MFA method and Passwords",
    "name": "Sign In (Passwords)",
    "sharedInteractions": [
      {
        "id": "3.success",
        "type": "success"
      }
    ]
  },
  "references": {},
  "screens": [
    {
      "contents": {
        "1sMmkeVxVT": {
          "custom": {},
          "displayName": "Error Message",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "color": "error",
            "data-type": "error-message",
            "full-width": false,
            "id": "1sMmkeVxVT",
            "italic": false,
            "text-align": "center",
            "variant": "body1"
          },
          "type": {
            "resolvedName": "ErrorMessage"
          }
        },
        "35R13zf5_Q": {
          "custom": {},
          "displayName": "Text",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "children": "Replace it with a new one",
            "full-width": false,
            "id": "35R13zf5_Q",
            "italic": false,
            "mode": "primary",
            "text-align": "center",
            "variant": "subtitle2"
          },
          "type": {
            "resolvedName": "Text"
          }
        },
        "5QWgYTNygk": {
          "custom": {
            "type": "input"
          },
          "displayName": "New Password",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "bordered": true,
            "confirm-label": "Confirm password",
            "confirm-placeholder": "Confirm password",
            "confirmInputProps": {},
            "full-width": true,
            "has-confirm": true,
            "id": "5QWgYTNygk",
            "name": "newPassword",
            "password-label": "New Password",
            "password-placeholder": "New Password",
            "required": true,
            "size": "md"
          },
          "type": {
            "resolvedName": "NewPassword"
          }
        },
        "LmrSIGOWZb": {
          "custom": {},
          "displayName": "Text",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "children": "Your password is expired",
            "full-width": false,
            "id": "LmrSIGOWZb",
            "italic": false,
            "mode": "primary",
            "text-align": "center",
            "variant": "subtitle1"
          },
          "type": {
            "resolvedName": "Text"
          }
        },
        "ROOT": {
          "custom": {},
          "displayName": "Container",
          "hidden": false,
          "isCanvas": true,
          "linkedNodes": {},
          "nodes": [
            "LmrSIGOWZb",
            "35R13zf5_Q",
            "qWeslhZQAo",
            "5QWgYTNygk",
            "update-password",
            "1sMmkeVxVT"
          ],
          "props": {
            "align": "center",
            "background": "",
            "data-editor-type": "container",
            "direction": "column",
            "id": "ROOT",
            "justify": "center",
            "paddingX": "4",
            "paddingY": "8",
            "spaceBetween": "4",
            "width": "100%"
          },
          "type": {
            "resolvedName": "Container"
          }
        },
        "qWeslhZQAo": {
          "custom": {},
          "displayName": "Login Password",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "bordered": true,
            "full-width": true,
            "id": "qWeslhZQAo",
            "label": "Current Password",
            "name": "password",
            "placeholder": "Current Password",
            "required": true,
            "size": "md",
            "type": "password"
          },
          "type": {
            "resolvedName": "Password"
          }
        },
        "update-password": {
          "custom": {
            "type": "button"
          },
          "displayName": "Button",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "children": "Update password",
            "data-type": "button",
            "formNoValidate": false,
            "full-width": true,
            "id": "update-password",
            "mode": "primary",
            "size": "md",
            "variant": "contained"
          },
          "type": {
            "resolvedName": "Button"
          }
        }
      },
      "interactions": [
        {
          "id": "update-password",
          "label": "Update password"
        }
      ],
      "screenId": "SC2wWY2qAjIHsqFWp5qWBFjHUvMOZ"
    },
    {
      "contents": {
        "1sMmkeVxVT": {
          "custom": {},
          "displayName": "Error Message",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "color": "error",
            "data-type": "error-message",
            "full-width": false,
            "hide-when-empty": true,
            "id": "1sMmkeVxVT",
            "italic": false,
            "mode": "error",
            "text-align": "center",
            "variant": "body1"
          },
          "type": {
            "resolvedName": "ErrorMessage"
          }
        },
        "LmrSIGOWZb": {
          "custom": {},
          "displayName": "Text",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "children": "Enter the 6-digit code from your Authenticator application",
            "full-width": false,
            "id": "LmrSIGOWZb",
            "italic": false,
            "mode": "primary",
            "text-align": "center",
            "variant": "subtitle2"
          },
          "type": {
            "resolvedName": "Text"
          }
        },
        "ROOT": {
          "custom": {},
          "displayName": "Container",
          "hidden": false,
          "isCanvas": true,
          "linkedNodes": {},
          "nodes": ["LmrSIGOWZb", "oneTimeCodeId", "1sMmkeVxVT"],
          "props": {
            "align": "center",
            "background": "",
            "data-editor-type": "container",
            "direction": "column",
            "id": "ROOT",
            "justify": "center",
            "paddingX": "4",
            "paddingY": "8",
            "spaceBetween": "4",
            "width": "100%"
          },
          "type": {
            "resolvedName": "Container"
          }
        },
        "oneTimeCodeId": {
          "custom": {
            "type": "oneTimeCode"
          },
          "displayName": "One Time Code",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "bordered": true,
            "data-auto-submit": true,
            "data-errormessage-pattern-mismatch": "Must be a 6 digit number",
            "digits": 6,
            "full-width": false,
            "id": "oneTimeCodeId",
            "label": "",
            "name": "code",
            "required": true,
            "size": "lg",
            "type": "tel"
          },
          "type": {
            "resolvedName": "Code"
          }
        }
      },
      "interactions": [
        {
          "id": "oneTimeCodeId",
          "label": "Verify OTP code"
        }
      ],
      "screenId": "SC2wZNBaG19JLoesw1Fxfwd7rPUUT"
    },
    {
      "contents": {
        "1sMmkeVxVT": {
          "custom": {},
          "displayName": "Error Message",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "color": "error",
            "data-type": "error-message",
            "full-width": false,
            "id": "1sMmkeVxVT",
            "italic": false,
            "text-align": "center",
            "variant": "body1"
          },
          "type": {
            "resolvedName": "ErrorMessage"
          }
        },
        "35R13zf5_Q": {
          "custom": {},
          "displayName": "Text",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "children": "Replace it with a new one",
            "full-width": false,
            "id": "35R13zf5_Q",
            "italic": false,
            "mode": "primary",
            "text-align": "center",
            "variant": "subtitle2"
          },
          "type": {
            "resolvedName": "Text"
          }
        },
        "5QWgYTNygk": {
          "custom": {
            "type": "input"
          },
          "displayName": "New Password",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "bordered": true,
            "confirm-label": "Confirm password",
            "confirm-placeholder": "Confirm password",
            "confirmInputProps": {},
            "full-width": true,
            "has-confirm": true,
            "id": "5QWgYTNygk",
            "name": "newPassword",
            "password-label": "New Password",
            "password-placeholder": "New Password",
            "required": true,
            "size": "md"
          },
          "type": {
            "resolvedName": "NewPassword"
          }
        },
        "LmrSIGOWZb": {
          "custom": {},
          "displayName": "Text",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "children": "Your password is expired",
            "full-width": false,
            "id": "LmrSIGOWZb",
            "italic": false,
            "mode": "primary",
            "text-align": "center",
            "variant": "subtitle1"
          },
          "type": {
            "resolvedName": "Text"
          }
        },
        "ROOT": {
          "custom": {},
          "displayName": "Container",
          "hidden": false,
          "isCanvas": true,
          "linkedNodes": {},
          "nodes": [
            "LmrSIGOWZb",
            "35R13zf5_Q",
            "qWeslhZQAo",
            "5QWgYTNygk",
            "update-password",
            "1sMmkeVxVT"
          ],
          "props": {
            "align": "center",
            "background": "",
            "data-editor-type": "container",
            "direction": "column",
            "id": "ROOT",
            "justify": "center",
            "paddingX": "4",
            "paddingY": "8",
            "spaceBetween": "4",
            "width": "100%"
          },
          "type": {
            "resolvedName": "Container"
          }
        },
        "qWeslhZQAo": {
          "custom": {},
          "displayName": "Login Password",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "bordered": true,
            "full-width": true,
            "id": "qWeslhZQAo",
            "label": "Current Password",
            "name": "password",
            "placeholder": "Current Password",
            "required": true,
            "size": "md",
            "type": "password"
          },
          "type": {
            "resolvedName": "Password"
          }
        },
        "update-password": {
          "custom": {
            "type": "button"
          },
          "displayName": "Button",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "children": "Update password",
            "data-type": "button",
            "formNoValidate": false,
            "full-width": true,
            "id": "update-password",
            "mode": "primary",
            "size": "md",
            "variant": "contained"
          },
          "type": {
            "resolvedName": "Button"
          }
        }
      },
      "interactions": [
        {
          "id": "update-password",
          "label": "Update password"
        }
      ],
      "screenId": "SC2wZNUGGEcWBw3H4wxKCUN3vitTB"
    },
    {
      "contents": {
        "1sMmkeVxVT": {
          "custom": {},
          "displayName": "Error Message",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "align": "center",
            "data-type": "error-message",
            "full-width": false,
            "id": "1sMmkeVxVT",
            "italic": false,
            "link-target-blank": true,
            "mode": "error",
            "text-align": "center",
            "variant": "body1"
          },
          "type": {
            "resolvedName": "ErrorMessage"
          }
        },
        "LmrSIGOWZb": {
          "custom": {},
          "displayName": "Text",
          "hidden": false,
          "isCanvas": false,
          "linkedNodes": {},
          "nodes": [],
          "parent": "ROOT",
          "props": {
            "align": "center",
            "children": "Bot Detected!\n\n",
            "full-width": false,
            "id": "LmrSIGOWZb",
            "isEnriched": true,
            "italic": false,
            "link-target-blank": true,
            "mode": "primary",
            "text-align": "center",
            "variant": "h2"
          },
          "type": {
            "resolvedName": "Text"
          }
        },
        "ROOT": {
          "custom": {},
          "displayName": "Container",
          "hidden": false,
          "isCanvas": true,
          "linkedNodes": {},
          "nodes": ["LmrSIGOWZb", "1sMmkeVxVT"],
          "props": {
            "align": "center",
            "background": "",
            "data-editor-type": "container",
            "direction": "column",
            "id": "ROOT",
            "justify": "center",
            "paddingX": "4",
            "paddingY": "8",
            "space-between": "md",
            "spaceBetween": "4",
            "st-items-grow": 0,
            "width": "100%"
          },
          "type": {
            "resolvedName": "Container"
          }
        }
      },
      "screenId": "SC2wZNUHVNT89BnzbXVMZj9N09Qdr"
    }
  ]
}
